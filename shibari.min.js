"use strict";Object.observe||function(e,t){var n=function(e){var n=e.call(e),r=typeof r;return typeof t.alert=="object"?function(t){return n===e.call(t)||!!t&&typeof t.toString==r&&typeof t.valueOf==r&&/^\s*\bfunction\b/.test(""+t)}:function(t){return n===e.call(t)}}(e.prototype.toString),r=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},i=function(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t},s=function(e){return typeof e=="undefined"?!1:"get"in e||"set"in e},o=function(e){return typeof e=="undefined"?!1:"value"in e||"writable"in e},u=function(e,t){if(typeof e!="object")throw new TypeError("Object.observeObject called on non-object");if(n(t)===!1)throw new TypeError("Object.observeObject: Expecting function");if(Object.isFrozen(t)===!0)throw new TypeError("Object.observeObject: Expecting unfrozen function")},a=function(){var e=[],t=function(t,n){u(t,n),Object.getNotifier(t).addListener(n),e.indexOf(t)===-1?e.push(t):Object.getNotifier(t)._checkPropertyListing()};t.prototype.deliverChangeRecords=function(e){Object.getNotifier(e).deliverChangeRecords()},e.lastScanned=0;var n=function(e){return function(){var t=0,r=e.length,i=new Date,s=!1;for(t=e.lastScanned;t<r&&!s;t++)Object.getNotifier(e[t])._checkPropertyListing(),s=new Date-i>100;e.lastScanned=t<r?t:0,setTimeout(n,100)}}(e);return setTimeout(n,100),t}(),f=function(e){var t=[],n=[],o=!1,u=[],a=[],f=this;Object.defineProperty(f,"_watching",{get:function(e){return function(){return e}}(e)});var l=function(e,t){var n=typeof e[t],o=Object.getOwnPropertyDescriptor(e,t);if(t==="getNotifier"||s(o)||!o.enumerable)return!1;if(e instanceof Array&&r(t)){var f=u.length;return u[f]=t,a[f]=e[t],!0}return function(t,n){u[t]=n,a[t]=e[n],Object.defineProperty(e,n,{get:function(){return a[t]},set:function(r){i(a[t],r)||(Object.getNotifier(e).queueUpdate(e,n,"updated",a[t]),a[t]=r)}})}(u.length,t),!0};f._checkPropertyListing=function(e){var t=f._watching,n=Object.keys(t),i=0,s=n.length,o=[],c=u.slice(0),h=[],p,d=!e,v,m,g;for(i=0;i<s;i++)p=n[i],m=t[p],v=typeof m,(g=u.indexOf(p))===-1?l(t,p)&&d&&f.queueUpdate(t,p,"new",null,t[p]):(t instanceof Array&&r(p)&&a[g]!==m&&(d&&f.queueUpdate(t,p,"updated",a[g],m),a[g]=m),c.splice(c.indexOf(p),1));if(d){s=c.length;for(i=0;i<s;i++)g=u.indexOf(c[i]),f.queueUpdate(t,c[i],"deleted",a[g]),u.splice(g,1),a.splice(g,1)}},f.addListener=function(e){var n=t.indexOf(e);n===-1&&t.push(e)},f.removeListener=function(e){var n=t.indexOf(e);n>-1&&t.splice(n,1)},f.listeners=function(){return t},f.queueUpdate=function(e,t,n,r){this.queueUpdates([{type:n,object:e,name:t,oldValue:r}])},f.queueUpdates=function(e){var t=this,r=0,i=e.length||0,s;for(r=0;r<i;r++)s=e[r],n.push(s);o&&clearTimeout(o),o=setTimeout(function(){o=!1,t.deliverChangeRecords()},100)},f.deliverChangeRecords=function(){var e=0,r=t.length,i=!0;for(e=0;e<r&&i;e++)typeof t[e]=="function"&&(t[e]===console.log?console.log(n):i=!t[e](n));n=[]},f._checkPropertyListing(!0)},l=[],c=[];e.getNotifier=function(e){var t=c.indexOf(e),n=t>-1?l[t]:!1;return n||(t=c.length,c[t]=e,n=l[t]=new f(e)),n},e.observe=function(e,t){return new a(e,t)},e.unobserve=function(t,n){u(t,n),e.getNotifier(t).removeListener(n)}}(Object,this);var Shibari=function(){};Shibari.BIND_ATTRIBUTES_PREFIX="bind-",Shibari.getAttribute=function(e,t){return $(e).attr(t)},Shibari.setAttribute=function(e,t,n){$(e).attr(t,n)},Shibari.getInputValue=function(e){return $(e).val()},Shibari.setInputValue=function(e,t){$(e).val(t)},Shibari.getChildren=function(e){return $(e).children()},Shibari.setHTML=function(e,t){$(e).html(t)},Shibari.onChange=function(e,t){$(e).change(t)},Shibari.triggerEvent=function(e,t){$(e).trigger(t)},Shibari.bind=function(e,t){if(!t)throw"Context does not exist";e.shibariContext=t;var n=e.attributes;if(n)for(var r=0;r<n.length;r++)n[r].name!=Shibari.BIND_ATTRIBUTES_PREFIX+"context"&&(n[r].name==Shibari.BIND_ATTRIBUTES_PREFIX+"content"?Shibari.bindContentToValue(children[cel],n[r].name.substr(5),t,Shibari.getAttribute(children[cel],n[r].name)):n[r].name.indexOf(Shibari.BIND_ATTRIBUTES_PREFIX)==0&&Shibari.bindToValue(e,n[r].name.substr(5),t,Shibari.getAttribute(e,n[r].name)));Shibari.bindChildren(e,t)},Shibari.bindChildren=function(e,t){var n=Shibari.getChildren(e);for(var r=0;r<n.length;r++){var i=n[r].attributes,s=t;if(i)for(var o=0;o<i.length;o++){if(i[o].name==Shibari.BIND_ATTRIBUTES_PREFIX+"context"){var u=t[Shibari.getAttribute(n[r],i[o].name)];if(!u)throw"Context does not exist";s=u}i[o].name==Shibari.BIND_ATTRIBUTES_PREFIX+"content"?Shibari.bindContentToValue(n[r],i[o].name.substr(5),t,Shibari.getAttribute(n[r],i[o].name)):i[o].name.indexOf(Shibari.BIND_ATTRIBUTES_PREFIX)==0&&Shibari.bindToValue(n[r],i[o].name.substr(5),t,Shibari.getAttribute(n[r],i[o].name))}s!=t?Shibari.getChildren(n[r]).length>0&&Shibari.bind(n[r],s):Shibari.getChildren(n[r]).length>0&&Shibari.bindChildren(n[r],s)}},Shibari.bindContentToValue=function(e,t,n,r){Shibari.setHTML(e,n[r]),Object.observe(n,function(t){Shibari.setHTML(e,n[r])})},Shibari.bindToValue=function(e,t,n,r){var i=!1;e.nodeName=="INPUT"?(t=="value"&&Shibari.onChange(e,function(){if(!i){i=!0;var t=Shibari.getInputValue(e);n[r]=t}else i=!1}),i=!0,Shibari.setAttribute(e,t,n[r]),t=="value"&&Shibari.triggerEvent(e,"change"),Object.observe(n,function(s){for(var o=0;o<s.length;o++)s[o].name==r&&(i?i=!1:(i=!0,t=="value"?(Shibari.setInputValue(e,n[r]),Shibari.triggerEvent(e,"change")):Shibari.setAttribute(e,t,n[r])))})):Object.observe(n,function(i){Shibari.setAttribute(e,t,n[r])})}